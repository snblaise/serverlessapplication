{"version":3,"names":["_getJestObj","mock","jest","require","handler","createMockContext","overrides","awsRequestId","functionName","functionVersion","memoryLimitInMB","getRemainingTimeInMillis","describe","beforeEach","clearAllMocks","test","event","action","data","name","context","result","expect","statusCode","toBe","JSON","parse","body","success","status","headers","id","error","toHaveProperty","correlationId"],"sources":["index.test.js"],"sourcesContent":["const { handler } = require('./index');\n\n// Mock AWS Lambda Powertools\njest.mock('@aws-lambda-powertools/logger');\njest.mock('@aws-lambda-powertools/metrics');\njest.mock('@aws-lambda-powertools/tracer');\n\n// Mock context object\nconst createMockContext = (overrides = {}) => ({\n  awsRequestId: 'test-request-id-123',\n  functionName: 'test-function',\n  functionVersion: '1',\n  memoryLimitInMB: 128,\n  getRemainingTimeInMillis: () => 30000,\n  ...overrides,\n});\n\ndescribe('Lambda Handler', () => {\n  beforeEach(() => {\n    jest.clearAllMocks();\n  });\n\n  describe('Successful Operations', () => {\n    test('should handle create action successfully', async () => {\n      const event = {\n        action: 'create',\n        data: {\n          name: 'test-item',\n        },\n      };\n\n      const context = createMockContext();\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(200);\n      expect(JSON.parse(result.body).success).toBe(true);\n      expect(JSON.parse(result.body).data.name).toBe('test-item');\n      expect(JSON.parse(result.body).data.status).toBe('created');\n      expect(result.headers['X-Correlation-ID']).toBe(context.awsRequestId);\n    });\n\n    test('should handle update action successfully', async () => {\n      const event = {\n        action: 'update',\n        data: {\n          id: 'test-id-123',\n        },\n      };\n\n      const context = createMockContext();\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(200);\n      expect(JSON.parse(result.body).success).toBe(true);\n      expect(JSON.parse(result.body).data.id).toBe('test-id-123');\n      expect(JSON.parse(result.body).data.status).toBe('updated');\n    });\n\n    test('should handle delete action successfully', async () => {\n      const event = {\n        action: 'delete',\n        data: {\n          id: 'test-id-456',\n        },\n      };\n\n      const context = createMockContext();\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(200);\n      expect(JSON.parse(result.body).success).toBe(true);\n      expect(JSON.parse(result.body).data.id).toBe('test-id-456');\n      expect(JSON.parse(result.body).data.status).toBe('deleted');\n    });\n  });\n\n  describe('Error Handling', () => {\n    test('should handle invalid event object', async () => {\n      const event = null;\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n      expect(JSON.parse(result.body).error).toBe('Internal server error');\n    });\n\n    test('should handle missing action field', async () => {\n      const event = {\n        data: { name: 'test' },\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n    });\n\n    test('should handle unsupported action', async () => {\n      const event = {\n        action: 'unsupported',\n        data: {},\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n    });\n\n    test('should handle missing required fields for create', async () => {\n      const event = {\n        action: 'create',\n        data: {},\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n    });\n\n    test('should handle missing required fields for update', async () => {\n      const event = {\n        action: 'update',\n        data: {},\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n    });\n\n    test('should handle missing required fields for delete', async () => {\n      const event = {\n        action: 'delete',\n        data: {},\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(500);\n      expect(JSON.parse(result.body).success).toBe(false);\n    });\n  });\n\n  describe('Response Format', () => {\n    test('should return proper response structure for success', async () => {\n      const event = {\n        action: 'create',\n        data: { name: 'test' },\n      };\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result).toHaveProperty('statusCode');\n      expect(result).toHaveProperty('headers');\n      expect(result).toHaveProperty('body');\n      expect(result.headers).toHaveProperty('Content-Type', 'application/json');\n      expect(result.headers).toHaveProperty('X-Correlation-ID');\n\n      const body = JSON.parse(result.body);\n      expect(body).toHaveProperty('success');\n      expect(body).toHaveProperty('data');\n      expect(body).toHaveProperty('correlationId');\n    });\n\n    test('should return proper response structure for error', async () => {\n      const event = null;\n      const context = createMockContext();\n\n      const result = await handler(event, context);\n\n      expect(result).toHaveProperty('statusCode', 500);\n      expect(result).toHaveProperty('headers');\n      expect(result).toHaveProperty('body');\n      expect(result.headers).toHaveProperty('Content-Type', 'application/json');\n      expect(result.headers).toHaveProperty('X-Correlation-ID');\n\n      const body = JSON.parse(result.body);\n      expect(body).toHaveProperty('success', false);\n      expect(body).toHaveProperty('error');\n      expect(body).toHaveProperty('correlationId');\n    });\n  });\n\n  describe('Context Handling', () => {\n    test('should use correlation ID from context', async () => {\n      const event = {\n        action: 'create',\n        data: { name: 'test' },\n      };\n      const context = createMockContext({\n        awsRequestId: 'custom-correlation-id',\n      });\n\n      const result = await handler(event, context);\n\n      expect(result.headers['X-Correlation-ID']).toBe('custom-correlation-id');\n      expect(JSON.parse(result.body).correlationId).toBe('custom-correlation-id');\n    });\n\n    test('should handle different function versions', async () => {\n      const event = {\n        action: 'create',\n        data: { name: 'test' },\n      };\n      const context = createMockContext({\n        functionVersion: '$LATEST',\n      });\n\n      const result = await handler(event, context);\n\n      expect(result.statusCode).toBe(200);\n    });\n  });\n});\n"],"mappings":"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","ignoreList":[]}